<!DOCTYPE html>
<html>

<head>
    <title>Predicción de Vivienda</title>
</head>

<body>
    <h1>Introduce los datos de la vivienda</h1>
    <form id="formulario">
        <input type="number" name="bathrooms" placeholder="Baños" required><br>
        <input type="number" name="bedrooms" placeholder="Habitaciones" required><br>
        <input type="number" name="sqft_living" placeholder="Superficie habitable" required><br>
        <input type="number" name="sqft_lot" placeholder="Tamaño del lote" required><br>
        <input type="number" name="floors" placeholder="Pisos" required><br>
        <input type="number" name="view" placeholder="Vista (0-4)" required><br>
        <input type="number" name="grade" placeholder="Calidad (1-13)" required><br>
        <input type="number" name="sqft_above" placeholder="Superficie sobre tierra" required><br>
        <input type="number" name="sqft_basement" placeholder="Superficie sótano" required><br>
        <input type="number" name="yr_built" placeholder="Año construcción" required><br>
        <input type="number" name="lat" step="0.000001" placeholder="Latitud" required><br>
        <input type="number" name="long" step="0.000001" placeholder="Longitud" required><br>
        <input type="number" name="sqft_living15" placeholder="Superficie habitable 15" required><br>
        <input type="number" name="sqft_lot15" placeholder="Tamaño del lote 15" required><br>
        <!-- Variables dummy de condición -->
        <label>Condición (marca solo una):</label><br>
        <input type="radio" name="Average" value="1">Average
        <input type="radio" name="Fair" value="1">Fair
        <input type="radio" name="Good" value="1">Good
        <input type="radio" name="VeryGood" value="1">VeryGood
        <input type="radio" name="Poor" value="1">Poor<br><br>
        <button type="submit">Predecir</button>
    </form>
    <p id="respuesta"></p>
    <script>
        const form = document.getElementById("formulario");
        form.addEventListener("submit", async function(e) {
            e.preventDefault();
            const formData = new FormData(form);
            const keys = ["Average", "Fair", "Good", "VeryGood", "Poor"];
            keys.forEach(key => {
                if (!formData.has(key)) {
                    formData.append(key, 0);
                }
            });
            try {
                const response = await fetch("/predict", {
                    method: "POST",
                    body: formData
                });
                const data = await response.json();
                console.log(":marca_de_verificación_blanca: JSON recibido:", data);
                document.getElementById("respuesta").innerText = data.resultado || data.Error;
            } catch (error) {
                const texto = await response.text();
                console.log(":advertencia: Respuesta no JSON:", texto);
                document.getElementById("respuesta").innerText = ":advertencia: El servidor no devolvió JSON válido.";
            }
        });
    </script>
</body>

</html>